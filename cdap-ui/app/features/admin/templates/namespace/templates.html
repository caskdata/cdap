<div class="row">
  <div class="col-xs-6">
    <h2>Create Template</h2>
  </div>
  <div class="col-xs-6 text-right">
    <button class="btn btn-success" ng-click="TemplatesController.save()">Save</button>
  </div>
</div>
<label class="label-control">Choose Templates</label>
<select ng-model="TemplatesController.template" class="form-control">
  <option value="ETLBatch">ETL Batch</option>
  <option value="ETLRealtime">ETL Realtime</option>
</select>

<div ng-if="TemplatesController.template">
  <label class="label-control">Choose Plugin Type</label>
  <select ng-model="TemplatesController.pluginType" class="form-control">
    <option value="source">Source</option>
    <option value="transform">Transform</option>
    <option value="sink">Sink</option>
  </select>
</div>

<div ng-if="TemplatesController.pluginList.length > 0">
  <label class="label-control">Choose Plugin</label>
  <select ng-model="TemplatesController.plugin" class="form-control">
    <option ng-repeat="plugin in TemplatesController.pluginList" value="{{plugin.name}}">{{plugin.name}}</option>
  </select>
</div>

<div ng-if="TemplatesController.plugin">
  <h3>Plugin Properties</h3>

  <label class="label-control">Template Name</label>
  <input type="text" class="form-control" ng-model="TemplatesController.pluginConfig.templateName">

  <div ng-repeat="group in TemplatesController.groups.position">
    <div class="widget-group-container">
      <h4>{{TemplatesController.groups[group].display}}</h4>
      <div ng-repeat="field in TemplatesController.groups[group].position">
        <div ng-if="field !== 'schema'">
          <div class="form-group">
            <label class="control-label"
                    ng-init="title=TemplatesController.groups[group].fields[field].info;description=TemplatesController.groups[group].fields[field].description">
              <span>{{TemplatesController.groups[group].fields[field].label}}</span>
              <span class="fa fa-info-circle"
                    tooltip="{{description}}"
                    tooltip-placement="right"
                    tooltip-append-to-body="true">
              </span>
              <span class="fa fa-asterisk" ng-if="TemplatesController.pluginConfig._backendProperties[field].required"></span>
            </label>
            <div>
              <div data-name="field"
                   class="my-widget-container"
                   data-model="TemplatesController.pluginConfig.properties[field]"
                   data-myconfig="TemplatesController.groups[group].fields[field]"
                   data-properties="TemplatesController.pluginConfig.properties"
                   widget-container>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div>
    <div class="output-schema">
      <h4>Output Schema</h4>

      <fieldset ng-disabled="isDisabled" ng-if="TemplatesController.pluginConfig.outputSchema || !isDisabled || plugin.properties.format === 'clf' || TemplatesController.pluginConfig.properties.format === 'syslog'">
        <my-schema-editor
          ng-model="TemplatesController.pluginConfig.outputSchema"
          data-disabled="TemplatesController.pluginConfig.implicitSchema"
          ng-if="TemplatesController.plugin !== 'Stream' && TemplatesController.plugin !== 'Kafka'"></my-schema-editor>
        <my-stream-properties
          ng-model="TemplatesController.pluginConfig.outputSchema"
          plugins="TemplatesController.pluginConfig.properties"
          ng-if="TemplatesController.plugin === 'Stream' || TemplatesController.plugin === 'Kafka'"
        ></my-stream-properties>
      </fieldset>

      <div ng-if="!TemplatesController.pluginConfig.outputSchema && isDisabled && TemplatesController.pluginConfig.properties.format !== 'clf' && TemplatesController.pluginConfig.properties.format !== 'syslog'">
        <div class="well well-lg">
          <h4>There is no output schema</h4>
        </div>
      </div>
    </div>
  </div>

</div>
